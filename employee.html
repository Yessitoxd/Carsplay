<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Panel Empleado - CarsPlay</title>
  <link rel="stylesheet" href="styles.css">
  <!-- layout/styles come from styles.css; inline white-box removed so grid can expand -->
</head>
<body>
  <!-- Employee toggle (top-left) -->
  <button id="employeeToggle" class="employee-toggle" aria-expanded="false"> <span id="employeeName">Empleado</span> ▾</button>

  <!-- Sidebar panel -->
  <aside id="employeePanel" class="employee-panel" aria-hidden="true">
    <div class="panel-inner">
      <h2 id="panelUser">Empleado</h2>
      <div class="panel-section">
        <strong id="panelTotalLabel">Dinero obtenido (Hoy):</strong>
        <div id="panelTotal">C$ 0</div>
        <div id="panelTimeFormat" style="font-size:12px;color:#666;margin-top:6px"></div>
      </div>
      <div class="panel-actions">
        <button id="logoutBtn" class="btn secondary">Cerrar sesión</button>
      </div>
    </div>
  </aside>

  <main class="content">
    <div class="box">
      <h1>Panel del Empleado</h1>
      <div class="grid" id="stations"></div>

      <hr>
    </div>
  </main>

  <script>
    // Default API base behavior:
    // - If `window.API_BASE` is explicitly provided (e.g. injected by deployment), keep it.
    // - If running on localhost (dev), use the local origin so you can test locally.
    // - Otherwise (production / Netlify), default to the Render backend.
    if (!window.API_BASE) {
      const HOST_RENDER = 'https://carsplay.onrender.com';
      try {
        const host = (window.location && window.location.hostname) ? window.location.hostname : '';
        if (host === 'localhost' || host === '127.0.0.1') {
          window.API_BASE = window.location.origin;
        } else if (window.location && window.location.protocol === 'file:') {
          window.API_BASE = 'http://localhost:3000';
        } else {
          // Default to Render production backend for deployed frontends
          window.API_BASE = HOST_RENDER;
        }
      } catch (e) {
        window.API_BASE = HOST_RENDER;
      }
    }
    console.info('Using API base:', window.API_BASE);
  </script>
  <script>
    // Keep-alive ping to backend every 5 minutes (employee UI)
    (function(){
      try {
        const base = window.API_BASE ? window.API_BASE.replace(/\/$/, '') : '';
        if (!base) return;
        const ping = async () => {
          try { await fetch((base || '') + '/api/ping', { method: 'GET', cache: 'no-cache' }); } catch(e){}
        };
        setTimeout(ping, 2000);
        setInterval(ping, 5 * 60 * 1000);
      } catch(e){}
    })();
  </script>
  <script src="employee.js"></script>
</body>
</html>
